# Архитектура проекта Telegram-бота для фитнес-тренеров

## Общая структура проекта

```
TELEGRAMM_BOT_PROD/
├── bot.py                  # Основной файл запуска бота
├── config/                 # Конфигурационные файлы
│   ├── __init__.py
│   └── config.py           # Модуль загрузки конфигурации из .env
├── data/                   # Данные для RAG-системы
├── database/               # Модели и операции с БД
│   ├── __init__.py
│   └── base.py             # Настройка подключения к базе данных
├── handlers/               # Обработчики команд бота
│   └── __init__.py
├── keyboards/              # Клавиатуры и меню
│   └── __init__.py
├── models/                 # Модели данных и состояний
│   └── __init__.py
├── rag/                    # Система RAG для поиска информации
│   └── __init__.py
├── services/               # Бизнес-логика (расчет КБЖУ, планы питания)
│   └── __init__.py
├── utils/                  # Вспомогательные функции
│   └── __init__.py
├── Doc/                    # Документация проекта
│   ├── PLAN_RAZRABOTKI.md  # План разработки проекта
│   ├── TZ_BOT.md           # Техническое задание
│   ├── JOURNAL.md          # Журнал разработки
│   └── ARCHITECTURE.md     # Описание архитектуры проекта
├── Rules/                  # Правила разработки
├── requirements.txt        # Зависимости проекта
├── .env.example            # Пример файла с переменными окружения
├── .gitignore              # Файлы, игнорируемые Git
└── README.md               # Общая информация о проекте
```

## Описание компонентов

### 1. Основные файлы

- **bot.py** - Точка входа в приложение, инициализирует бота и диспетчер, запускает поллинг.
- **.env.example** - Шаблон для настройки переменных окружения.
- **requirements.txt** - Список зависимостей проекта.
- **README.md** - Общее описание проекта, инструкции по установке и запуску.

### 2. Модули проекта

#### config/
- **config.py** - Загрузка и предоставление конфигурационных параметров из .env-файла для всего приложения.

#### database/
- **base.py** - Настройка подключения к базе данных, инициализация ORM, предоставление сессий.

#### handlers/
Обработчики команд и сообщений бота (будут добавлены по мере разработки):
- Команды меню
- Обработка диалогов для добавления клиентов
- Обработка действий с клиентами
- Генерация планов питания

#### keyboards/
Модули для создания клавиатур Telegram-бота:
- Главное меню
- Клавиатуры для диалогов
- Инлайн-клавиатуры для работы с клиентами

#### models/
Модели данных:
- Модели Pydantic для валидации данных
- Модели SQLAlchemy для базы данных
- Модели состояний для FSM (Finite State Machine)

#### rag/
Система поиска информации (Retrieval Augmented Generation):
- Загрузка документов
- Векторизация данных
- Поисковые функции
- Интеграция с OpenAI

#### services/
Бизнес-логика приложения:
- Расчет КБЖУ по формуле Бенедикта
- Генерация планов питания
- Логика работы с клиентами

#### utils/
Вспомогательные функции:
- Форматирования данных
- Логирование
- Другие утилиты

### 3. Документация

#### Doc/
- **PLAN_RAZRABOTKI.md** - План разработки проекта
- **TZ_BOT.md** - Техническое задание
- **JOURNAL.md** - Журнал разработки с хронологией выполненных задач
- **ARCHITECTURE.md** - Описание архитектуры проекта (текущий документ)

### 4. Взаимодействие компонентов

1. **Пользователь** отправляет команду боту в Telegram
2. **Aiogram** обрабатывает входящую команду и передает ее в соответствующий **обработчик**
3. **Обработчик** взаимодействует с **сервисами** для выполнения бизнес-логики
4. **Сервисы** используют **модели данных** и **базу данных** для хранения/получения информации
5. При необходимости используется **RAG-система** для поиска информации
6. Результат возвращается пользователю с использованием соответствующей **клавиатуры**

### 5. Технический стек

- **Python** - основной язык программирования
- **aiogram** - библиотека для работы с Telegram Bot API
- **SQLAlchemy** - ORM для работы с базой данных
- **OpenAI API** - для генерации текстов с использованием GPT-4.1 nano
- **langchain** - для реализации RAG-системы
- **Pydantic** - для валидации данных

### 6. Окружения

Проект поддерживает три режима работы:
- **dev** - для разработки, с подробным логированием
- **test** - для тестирования
- **prod** - для продакшн, с минимальным логированием
